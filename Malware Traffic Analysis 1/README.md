# Malware Traffic Analysis 1

+ ## Table of Contents
    - [Q1. What is the IP address of the Windows VM that gets infected?](#q1-what-is-the-ip-address-of-the-windows-vm-that-gets-infected)
    - [Q2. What is the hostname of the Windows VM that gets infected?](#q2-what-is-the-hostname-of-the-windows-vm-that-gets-infected)
    - [Q3. What is the MAC address of the infected VM?](#q3-what-is-the-mac-address-of-the-infected-vm)
    - [Q4. What is the IP address of the compromised web site?](#q4-what-is-the-ip-address-of-the-compromised-web-site)
    - [Q5. What is the FQDN of the compromised website?](#q5-what-is-the-fqdn-of-the-compromised-website)
    - [Q6. What is the IP address of the server that delivered the exploit kit and malware?](#q6-what-is-the-ip-address-of-the-server-that-delivered-the-exploit-kit-and-malware)
    - [Q7. What is the FQDN that delivered the exploit kit and malware?](#q7-what-is-the-fqdn-that-delivered-the-exploit-kit-and-malware)
    - [Q8. What is the redirect URL that points to the exploit kit (EK) landing page?](#q8-what-is-the-redirect-url-that-points-to-the-exploit-kit--ek--landing-page)
    - [Q9. Other than CVE-2013-2551 IE exploit, another application was targeted by the EK and starts with "J". Provide the full application name.](#q9-other-than-cve-2013-2551-ie-exploit--another-application-was-targeted-by-the-ek-and-starts-with-j-provide-the-full-application-name)
    - [Q10. How many times was the payload delivered?](#q10-how-many-times-was-the-payload-delivered)
    - [Q12. The compromised website has a malicious script with a URL. What is this URL?](#q12-the-compromised-website-has-a-malicious-script-with-a-url-what-is-this-url)
    - [Q13. Extract the two exploit files. What are the MD5 file hashes? (comma-separated )](#q13-extract-the-two-exploit-files-what-are-the-md5-file-hashes-comma-separated-)

### Q1. What is the IP address of the Windows VM that gets infected?
Extract attached file, opne with [Wireshark](https://www.wireshark.org/)<br/>
We can see that only this private IP connects to the Internet.<br/>
![image](https://user-images.githubusercontent.com/58476264/148325989-f2f70019-2e73-49f3-be4e-7a591173e462.png)<br/>
**Answer:** 172.16.165.165

### Q2. What is the hostname of the Windows VM that gets infected?
Reference: [Wireshark Identifying Hosts and Users](https://unit42.paloaltonetworks.com/using-wireshark-identifying-hosts-and-users/)<br/>
Filter `bootp`, then choose DHCP Request<br/>
![image](https://user-images.githubusercontent.com/58476264/148326661-ed419d10-c4f6-47d1-84cb-b9a32b6cce05.png)
<br/>Expand DHCP Request, then click Option Host Name we will see Host Name of the Windows VM<br/>
![image](https://user-images.githubusercontent.com/58476264/148326864-914251f4-a7ec-4bd2-bbb5-ca1890ec2e49.png)<br/>
**Answer:** K34EN6W3N-PC 

### Q3. What is the MAC address of the infected VM?
Similarly, we will choose Option Client Identifier, the MAC will appear<br/>
![image](https://user-images.githubusercontent.com/58476264/148327593-f1a136da-5a61-4642-9758-929776f2379e.png)<br/>
**Answer:**  f0:19:af:02:9b:f1

### Q4. What is the IP address of the compromised web site?
At line 179, we see some communication between Windows VM and a strange IP<br/>
![image](images/1.png)<br/>
**Answer:** 82.150.140.30

### Q5. What is the FQDN of the compromised website?
We have already seen on Q4.<br/>
**Answer:** ciniholland.nl

### Q6. What is the IP address of the server that delivered the exploit kit and malware?
Select File -> Export Object -> HTTP <br/>
![](images/2.png)<br/>
At packet 1554, we see a hostname use PHPSSESID as a parameter, looks like it's doing something.<br/>
![](images/4.png)<br/>
View Details of packet 1554, I saw something look like Windows's path.<br/>
![](images/3.png)<br/>
**Answer:** 37.200.69.143

### Q7. What is the FQDN that delivered the exploit kit and malware?
Based on Q6.<br/>
**Answer:** stand.trustandprobaterealty.com

### Q8. What is the redirect URL that points to the exploit kit (EK) landing page?
Also in packet 1554, base on Referrer field.<br/>
![](images/5.png)<br/>
**Answer:** http://24corp-shop.com/

### Q9. Other than CVE-2013-2551 IE exploit, another application was targeted by the EK and starts with "J". Provide the full application name.
Use [NetworkMiner](https://www.netresec.com/?page=NetworkMiner) to load pcap file, at tab Files, we see some file with .jar and .swf extension downloaded.<br/>
![](images/6.png)<br/>
**Answer:** JAVA

### Q10. How many times was the payload delivered?
Use [Brim Security](https://www.brimdata.io/) to load the file, in Query select Suricata Alerts by Category, we see that Suricata is alert three times about Privacy Violation, it means that Windows VM has accessed to the malicious site.<br/>
![](images/7.png)<br/>
**Answer:** 3

### Q12. The compromised website has a malicious script with a URL. What is this URL?
We know the URL we are going to end up at is http://24corp-shop.com from earlier.<br/>
**Answer:** http://24corp-shop.com/

### Q13. Extract the two exploit files. What are the MD5 file hashes? (comma-separated )
Use NetworkMiner, two files are with .jar and .swf<br/>
![](images/8.png)<br/>
You can right click and calculate MD5 hash for them.<br/>
![](images/9.png)<br/>
**Answer:** 7b3baa7d6bb3720f369219789e38d6ab,1e34fdebbf655cebea78b45e43520ddf